using BoomRadio;
using BoomRadio.Model;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Text;

namespace TestBoomRadio.TestApi
{
    [TestClass]
    public class ParseSponsorsResponse
    {
        readonly Api api = new Api();

        [TestMethod]
        public void TestNormalResponse()
        {
            string sampleResponse = "[{\"id\":28682,\"date\":\"2021-07-20T14:47:20\",\"date_gmt\":\"2021-07-20T06:47:20\",\"guid\":{\"rendered\":\"https:\\/\\/boomradio.com.au\\/?post_type=sponsors&#038;p=28682\"},\"modified\":\"2021-07-20T14:47:20\",\"modified_gmt\":\"2021-07-20T06:47:20\",\"slug\":\"rhubarb-records\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/rhubarb-records\\/\",\"title\":{\"rendered\":\"Rhubarb Records\"},\"content\":{\"rendered\":\"\\n<p><strong>Rhubarb Records have been buying and selling new and used vinyl since 2013.<\\/strong><\\/p>\\n\\n\\n\\n<p><strong>Their stores in East Vic Park and Mount Lawley (inside of Local &amp; Aesthetic caf\\u00e9\\/retail space) have\\u00a0a huge selection of new &amp; used vinyl, cassettes, hi-fi and accessories.<\\/strong><\\/p>\\n\\n\\n\\n<p><strong>You can now view and purchase\\u00a0some of their\\u00a0items at rhubarbrecords.com<\\/strong><\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Rhubarb Records have been buying and selling new and used vinyl since 2013. Their stores in East Vic Park and Mount Lawley (inside of Local<span>&#8230;<\\/span><\\/p>\\n\",\"protected\":false},\"author\":23,\"featured_media\":28683,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/28682\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/23\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/28683\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=28682\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":28627,\"date\":\"2021-04-20T12:13:17\",\"date_gmt\":\"2021-04-20T04:13:17\",\"guid\":{\"rendered\":\"https:\\/\\/boomradio.com.au\\/?post_type=sponsors&#038;p=28627\"},\"modified\":\"2021-04-28T12:59:15\",\"modified_gmt\":\"2021-04-28T04:59:15\",\"slug\":\"subiaco-football-club\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/subiaco-football-club\\/\",\"title\":{\"rendered\":\"Subiaco Football Club\"},\"content\":{\"rendered\":\"\\n<p>The Subiaco Football Club are celebrating their 125th anniversary in the WAFL in season 2021 and BOOM Radio is along for the ride with BOOM being at every Subiaco home game handing out great prizes and bringing the fun.<\\/p>\\n\\n\\n\\n<p>To find out more information head to their website https:\\/\\/www.subiacofc.com.au\\/<\\/p>\\n\\n\\n\\n<figure class=\\\"wp-block-image size-large\\\"><img loading=\\\"lazy\\\" width=\\\"1024\\\" height=\\\"1024\\\" src=\\\"https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n-1024x1024.png\\\" alt=\\\"\\\" class=\\\"wp-image-28630\\\" srcset=\\\"https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n-1024x1024.png 1024w, https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n-600x600.png 600w, https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n-150x150.png 150w, https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n-768x768.png 768w, https:\\/\\/boomradio.com.au\\/wp-content\\/uploads\\/2021\\/04\\/178576168_265113155334667_3928562127644312713_n.png 1080w\\\" sizes=\\\"(max-width: 1024px) 100vw, 1024px\\\" \\/><\\/figure>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>The Subiaco Football Club are celebrating their 125th anniversary in the WAFL in season 2021 and BOOM Radio is along for the ride with BOOM<span>&#8230;<\\/span><\\/p>\\n\",\"protected\":false},\"author\":23,\"featured_media\":28629,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/28627\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/23\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/28629\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=28627\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":28547,\"date\":\"2020-10-27T14:12:29\",\"date_gmt\":\"2020-10-27T06:12:29\",\"guid\":{\"rendered\":\"https:\\/\\/boomradio.com.au\\/?post_type=sponsors&#038;p=28547\"},\"modified\":\"2020-10-27T14:15:09\",\"modified_gmt\":\"2020-10-27T06:15:09\",\"slug\":\"ink-remedy\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/ink-remedy\\/\",\"title\":{\"rendered\":\"Ink Remedy\"},\"content\":{\"rendered\":\"\\n<p>Established in 2015 Ink Remedy is a modern Tattoo studio that prides themselves on customer service and creating customised deigns for our each individual. <\\/p>\\n\\n\\n\\n<p>With 5 amazing artists who cover a broad range of styles you can book in a free consultation or discuss your ideas with them via our Facebook.<\\/p>\\n\\n\\n\\n<p>Phone: 92281222<\\/p>\\n\\n\\n\\n<p>Email: tattoo@inkremedy.net<\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Ink Remedy is a modern Tattoo Studio that is located at 18a\\/663 Newcastle St, Leederville right next door to Rhubarb Records.Established in 2015 Ink Remedy is a modern Tattoo studio that prides themselves on customer service and creating customised deigns for our each individual. <\\/p>\\n\",\"protected\":false},\"author\":23,\"featured_media\":28548,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/28547\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/23\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/28548\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=28547\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":28545,\"date\":\"2020-10-27T14:01:01\",\"date_gmt\":\"2020-10-27T06:01:01\",\"guid\":{\"rendered\":\"https:\\/\\/boomradio.com.au\\/?post_type=sponsors&#038;p=28545\"},\"modified\":\"2020-10-27T14:01:13\",\"modified_gmt\":\"2020-10-27T06:01:13\",\"slug\":\"rollerzone\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/rollerzone\\/\",\"title\":{\"rendered\":\"Rollerzone\"},\"content\":{\"rendered\":\"\\n<p>Rollerzone is WA&#8217;s largest Roller skating, and Blading Rink located in Malaga. Rollerzone is a\\u00a0<strong>family-owned<\\/strong>\\u00a0and operated\\u00a0business and is\\u00a0dedicated to providing a safe and family-friendly skating facility.<\\/p>\\n\\n\\n\\n<p>Why not skate on over to 299 Victoria Rd, Malaga WA 6090 today! <\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Rollerzone is WA&#8217;s largest Roller skating, and Blading Rink located in Malaga. Rollerzone is a family owned and operated business and is dedicated to providing a safe and family friendly skating facility.<\\/p>\\n\",\"protected\":false},\"author\":23,\"featured_media\":28546,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/28545\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/23\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/28546\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=28545\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":28367,\"date\":\"2020-06-17T09:54:47\",\"date_gmt\":\"2020-06-17T01:54:47\",\"guid\":{\"rendered\":\"http:\\/\\/localhost\\/boom_radio\\/?post_type=sponsors&#038;p=28367\"},\"modified\":\"2020-06-17T09:54:47\",\"modified_gmt\":\"2020-06-17T01:54:47\",\"slug\":\"richmond-street-records\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/richmond-street-records\\/\",\"title\":{\"rendered\":\"Richmond Street Records\"},\"content\":{\"rendered\":\"\\n<p>Richmond Street records is a training platform for students in the music business course, with a focus is to produce, coordinate and run events for the music department at North Metropolitan TAFE. As part of this, they run live music sessions both Online and In-person while also recording a CD to promoting the local bands as well as the label itself.<\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Richmond Street records is a training platform for students in the music business course.<\\/p>\\n\",\"protected\":false},\"author\":23,\"featured_media\":28368,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/28367\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/23\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/28368\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=28367\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":27637,\"date\":\"2019-10-30T06:51:36\",\"date_gmt\":\"2019-10-30T06:51:36\",\"guid\":{\"rendered\":\"http:\\/\\/localhost\\/boom_radio\\/?post_type=sponsors&#038;p=27637\"},\"modified\":\"2019-10-30T07:10:08\",\"modified_gmt\":\"2019-10-30T07:10:08\",\"slug\":\"north-metropolitan-tafe\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/north-metropolitan-tafe\\/\",\"title\":{\"rendered\":\"North Metropolitan TAFE\"},\"content\":{\"rendered\":\"\\n<p>Whether you\\u2019re just starting out in the workforce, looking to \\nupskill, changing careers or returning to work, North Metropolitan TAFE \\nhas the qualifications to take you in the right direction.<\\/p>\\n\\n\\n\\n<p>Take a look through this website and discover how our lecturers are \\nindustry focussed, our program&#8217;s input developed alongside industry \\nplayers and our facilities contemporary and tailored so you will be \\nskilled and job ready for whatever you choose to do.<\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Whether you\\u2019re just starting out in the workforce, looking to upskill, changing careers or returning to work, North Metropolitan TAFE has the qualifications to take<span>&#8230;<\\/span><\\/p>\\n\",\"protected\":false},\"author\":1,\"featured_media\":27627,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/27637\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/1\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/27627\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=27637\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":27635,\"date\":\"2019-10-30T06:44:54\",\"date_gmt\":\"2019-10-30T06:44:54\",\"guid\":{\"rendered\":\"http:\\/\\/localhost\\/boom_radio\\/?post_type=sponsors&#038;p=27635\"},\"modified\":\"2019-10-30T07:07:37\",\"modified_gmt\":\"2019-10-30T07:07:37\",\"slug\":\"wam\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/wam\\/\",\"title\":{\"rendered\":\"WAM\"},\"content\":{\"rendered\":\"\\n<p>\\nPassionately committed to championing Western Australia\\u2019s thriving music\\n industry since 1987, WAM (West Australian Music) is the peak music body\\n responsible for supporting, nurturing and growing all forms of \\ncontemporary music in WA.\\n\\n<\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Passionately committed to championing Western Australia\\u2019s thriving music industry since 1987, WAM (West Australian Music) is the peak music body responsible for supporting, nurturing and<span>&#8230;<\\/span><\\/p>\\n\",\"protected\":false},\"author\":1,\"featured_media\":27629,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/27635\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/1\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/27629\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=27635\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}},{\"id\":27626,\"date\":\"2019-10-30T06:36:22\",\"date_gmt\":\"2019-10-30T06:36:22\",\"guid\":{\"rendered\":\"http:\\/\\/localhost\\/boom_radio\\/?post_type=sponsors&#038;p=27626\"},\"modified\":\"2019-10-30T07:03:49\",\"modified_gmt\":\"2019-10-30T07:03:49\",\"slug\":\"oxford-yard\",\"status\":\"publish\",\"type\":\"sponsors\",\"link\":\"https:\\/\\/boomradio.com.au\\/sponsors\\/oxford-yard\\/\",\"title\":{\"rendered\":\"Oxford Yard\"},\"content\":{\"rendered\":\"\\n<p>Black Forrest Waffles on the specials board this weekend at the Yard! <br>Chocolate Waffles with Sour Cherries, Creme Anglaise, Coconut &amp; Chocolate Sauce, Vanilla Ice Cream,  Chocolate Shavings and Lemon Balm.  <\\/p>\\n\",\"protected\":false},\"excerpt\":{\"rendered\":\"<p>Black Forrest Waffles on the specials board this weekend at the Yard! Chocolate Waffles with Sour Cherries, Creme Anglaise, Coconut &amp; Chocolate Sauce, Vanilla Ice<span>&#8230;<\\/span><\\/p>\\n\",\"protected\":false},\"author\":1,\"featured_media\":27632,\"template\":\"\",\"_links\":{\"self\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\\/27626\"}],\"collection\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/sponsors\"}],\"about\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/types\\/sponsors\"}],\"author\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/users\\/1\"}],\"wp:featuredmedia\":[{\"embeddable\":true,\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media\\/27632\"}],\"wp:attachment\":[{\"href\":\"https:\\/\\/boomradio.com.au\\/wp-json\\/wp\\/v2\\/media?parent=27626\"}],\"curies\":[{\"name\":\"wp\",\"href\":\"https:\\/\\/api.w.org\\/{rel}\",\"templated\":true}]}}]";
            List<Sponsors> sponsors = api.CallPrivateMethod<List<Sponsors>>("ParseSponsorsResponse", sampleResponse);

            // Should be 8 shows
            Assert.IsTrue(sponsors.Count == 8);
            // Check a couple of details for first sponsor
            Assert.AreEqual(sponsors[0].ID, 28682);
            Assert.AreEqual(sponsors[0].SponsorName, "Rhubarb Records");
        }

        [TestMethod]
        public void TestEmptyResponse()
        {
            string sampleResponse = "[]";
            List<Sponsors> sponsors = api.CallPrivateMethod<List<Sponsors>>("ParseSponsorsResponse", sampleResponse);
            Assert.AreEqual(sponsors.Count, 0);
        }

        [TestMethod]
        public void TestInvalidResponse()
        {
            string sampleResponse = "{Invalid[Response{";
            Assert.ThrowsException<Newtonsoft.Json.JsonReaderException>(() =>
            {
                api.CallPrivateMethod<List<Sponsors>>("ParseSponsorsResponse", sampleResponse);
            });
        }
    }
}
